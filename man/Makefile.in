### Makefile.in for kerrighed manpages
### 
### Copyright 2006-2007 INRIA-IRISA
###        Jean Parpaillon <jean.parpaillon@irisa.fr>
###
manpages = \
	krgadm.1 \
	kerrighed.7 \
	kerrighed_nodes.5 \
	kerrighed_capabilities.7 \
	krgcapset.1 \
	krgcapset.2 \
	migrate.1 \
	migrate.2 \
	migrate_self.2 \
	restart.1 \
	checkpoint.1

EXTRA_DIST = 
EXTRA_CLEAN_FILES =
EXTRA_DISTCLEAN_FILES = 

#
# Under this line, nothing should be modified
#
DOCBOOK2MAN = @DB2MAN@

MANS_SOURCES = $(patsubst %, %.xml, $(manpages))

DISTFILES = $(MANS_SOURCES) $(EXTRA_DIST) Makefile.in
DISTCLEAN_FILES = $(EXTRA_DISTCLEAN_FILES) Makefile

CLEAN_FILES = $(manpages) $(EXTRA_CLEAN_FILES) manpage.links manpage.refs

PACKAGE_TARNAME=@PACKAGE_TARNAME@
srcdir=@srcdir@
prefix=@prefix@
mkdir_p = @mkdir_p@
mandir = @mandir@
INSTALL = @install_sh@
INSTALL_DATA = @INSTALL_DATA@

all: $(manpages)

%: $(srcdir)/%.xml
	$(DOCBOOK2MAN) -o $(CURDIR) man $<

distdir: $(DISTFILES)
	for distfile in $(DISTFILES); do \
	  distfile_dir=`dirname $$distfile`; \
	  if test "$$distfile_dir" = "$(srcdir)"; then \
	    cp -av $$distfile $(distdir); \
	  else \
	    test -d $(distdir)/$$distfile_dir || $(mkdir_p) $(distdir)/$$distfile_dir; \
	    cp -av $$distfile $(distdir)/$$distfile_dir; \
	  fi; \
	done

install: install-data
install-data: install-man
install-man: $(manpages)
	for section in `seq 1 9`; do \
	  $(mkdir_p) "$(DESTDIR)$(mandir)/man$$section"; \
	done
	for file in $(manpages); do \
	  sect=`echo $$file | sed 's/^.*\([0-9]\)/\1/'`; \
	  inst=`echo $$file | sed -e 's/^.*\///'`; \
	  $(INSTALL_DATA) "$$file" "$(DESTDIR)$(mandir)/man$$sect/$$inst"; \
	done

uninstall: uninstall-data
uninstall-data: uninstall-man
uninstall-man:
	for file in $(manpages); do \
	  sect=`echo $$file | sed 's/^.*\([0-9]\)/\1/'`; \
	  inst=`echo $$file | sed -e 's/^.*\///'`; \
	  rm -f "$(DESTDIR)$(mandir)/man$$sect/$$inst"; \
	done	

clean:
	rm -f $(CLEAN_FILES)

distclean: clean
	rm -f $(DISTCLEAN_FILES)